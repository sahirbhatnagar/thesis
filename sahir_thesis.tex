\documentclass[12pt,letterpaper]{report}


\input{latex_packages}
\input{latex_commands}
\input{def_mcgill}

%-----------------------------------------------------------------------------
% Student info
%-----------------------------------------------------------------------------

\SetTitle{\huge{Penalized Regression Methods for Interaction and Mixed-Effects Models with Applications to Genomic and Brain Imaging Data}}
\SetAuthor{Sahir Rai Bhatnagar}
\SetDegreeType{Doctor of Philosophy}
\SetDepartment{Department of Epidemiology, Biostatistics and Occupational Health}
\SetUniversity{McGill University}
\SetUniversityAddr{Montréal, Québec, Canada}
\SetThesisDate{August 2018}
\SetRequirements{A thesis submitted to McGill University in partial fulfillment of the requirements of the degree of Doctor of Philosophy}
\SetCopyright{Sahir Rai Bhatnagar 2018}

%-----------------------------------------------------------------------------
% Document stats here
%-----------------------------------------------------------------------------

\begin{document}

% Create title page
\maketitle

%-----------------------------------------------------------------------------
% Input any special commands below
%-----------------------------------------------------------------------------

% Conditional expression for faster build during "development cycle"
\newif\ifthesis
\thesistrue       % Final thesis version: Uncomment this line and comment the next one
%\thesisfalse    % Development cycle: Uncomment this line and comment the previous one (faster LaTeX compile)

% Final version? 
% This is used to add items only for final submission
\newif\iffinal
\finaltrue
%\finalfalse

\ifthesis
	% Only show these sections when we are building the 'thesis' version

	\begin{romanPagenumber}{2}
	
	\SetDedicationText{This thesis is dedicated to my family, Dadi, Taiji, Papa, Maa, Sameer, Chandni, Marie-Pierre Bhabhi, Louis (Ladoo), Mathieu (Mitoo), Amir, Navdeep, Carlos, Gloria, and Karen.
		}
	\Dedication	
	
	%-----------------------------------------------------------------------------
	% Acknowledgements:
	%   Among other acknowledgements, the student is required to declare the extent to which assistance (paid or unpaid) has 
	%   been given by members of staff, fellow students, research assistants, technicians, or others in the collection of materials 
	%   and data, the design and construction of apparatus, the performance of experiments, the analysis of data, and the 
	%   preparation of the thesis (including editorial help).
    %   In addition, it is appropriate to recognize the supervision and advice given by the thesis supervisor(s) and advisors.
	%-----------------------------------------------------------------------------		
	\SetAcknowledgeText{
I am sincerely grateful for my supervisor Dr. Celia Greenwood for her consistent support, career-oriented and personal advice, and the insightful conversations we have had over the past five years. Celia has many of the qualities that make for an excellent supervisor. She takes the time to learn each of her trainees qualities, and plays to their strengths while helping them with their weaknesses, instead of a one-size-fits-all approach. She prioritizes her students amidst her busy schedule and many academic responsibilities. Above all, she is willing to do everything in her power to ensure her students succeed. Celia's work ethic and genuine personality is contagious and I have been extremely fortunate to be able to learn from her everyday. To my co-supervisor Dr. Yi Yang, I am deeply thankful for his advice and guidance not only in professional issues, but also in all other fundamental aspects. I am grateful for all the knowledge he has shared with me regarding variable selection methods, and for all the time he spent with me going over my formulas and code. I would also like to express great thanks to my supervisors for financially supporting my travel for conferences throughout my PhD.\\
The data that we analyzed in this thesis was kindly made available by Dr.
Luigi Bouchard, and by Dr. Budhachandra Khundrakpam. I would like to extend my thanks to Dr. Bouchard and Dr. Khundrakpam for also sharing their subject matter expertise.\\
I acknowledge the usage of Calcul Qu\'{e}bec and Lady Davis Institute computational facilities; invaluable resources that enabled the computation in all three studies. In particular, my sincerest gratitude goes to Dr. Vincenzo Forgetta, for teaching me essential qsub and unix commands and managing the cluster so efficiently.\\ 
This work would not have been possible without the financial support of the Ludmer Center for Neuroinformatics and Mental Health.\\
Finally, I thank my family and friends for always providing support at key times.
}
	\Acknowledge	

	%-----------------------------------------------------------------------------
	% Preface and contributions
	% In the case of collaborative work presented in either a standard format or manuscript-based thesis, there must be an 
	% explicit statement of the contributions of all parties, including the student, in the Preface of the thesis. 
   %  The Preface of a Doctoral thesis must also include a statement clearly indicating those elements of the thesis that 
   %  are considered original scholarship and distinct contributions to knowledge. 
	%-----------------------------------------------------------------------------		
	\SetPrefaceText{
This thesis contains new research in addition to an introductory overview of
		certain methods in high-dimensional data analysis.\\
Chapters~\ref{ch:introduction} and~\ref{ch:litreview} contains an original introduction and summary of selected methods in high-dimensional data analysis. These chapters were written entirely by Sahir Rai Bhatnagar (SRB) and edited and
corrected by Celia MT Greenwood (CMTG) and Yi Yang (YY).\\
The idea for the study in Chapter~\ref{ch:sail} was conceived by SRB, YY and CMTG. All
methodological work, writing, programming, and analysis was carried out by SRB
with CMTG and YY as advisors, editors (also contributing small amounts of content
directly) and troubleshooters. Amanda Lovato contributed to testing the software. \\
Chapter~\ref{ch:ggmix} was conceptualized by SRB and Karim Oualkacha (KO). SRB carried out the methodological work, writing, programming, and analysis. Marie Forest provided support for analyzing the UK Biobank data for simulation studies. Support for the theoretical write-up and implementation was given by KO and YY. KO, YY and CMTG all served as advisors and editors. \\ 
For Chapter~\ref{ch:eclust}, SRB, CMTG, YY, and Mathieu Blanchette contributed to the conceptualization of this research; SRB, Luigi Bouchard, and Budhachandra Khundrakpam contributed to the  data  curation; SRB contributed to the formal  analysis, software, visualization; SRB and CMTG contributed to the methodology;  SRB and CMTG contributed to  writing  the original draft; All authors contributed to editing the draft.\\
Chapter~\ref{ch:conclusion}, which concludes the thesis, was written by SRB and edited by CMTG and YY.
	}
	\Preface	

\begin{comment}
 Bhatnagar SR, Yang Y, Khundrakpam B, Evans A, Blanchette M, Bouchard L, Greenwood CMT (2017). An analytic approach for interpretable predictive models in high dimensional data, in the presence
 of interactions with exposures. Genetic Epidemiology. Apr 1;42(3):233-49. DOI 10.1002/gepi.22112. \\
 Software: \url{https://cran.r-project.org/package=eclust}\\ 
 SRB, CMTG, YY, and MB contributed to the conceptualization of this research; SRB, LB, and BK contributed to the  data  curation; SRB contributed to the formal  analysis, software, visualization; SRB and CMTG contributed to the methodology;  SRB and CMTG contributed to  writing  the original draft; All authors contributed to editing the draft.
 \\
 \\
 \textbf{Manuscript 2:} Bhatnagar SR, Yang Y, Lovato A, Greenwood CMT (2018+). Sparse Additive Interaction Models.\\
 Software: \url{https://github.com/greemwoodlab/sail}\\
 SRB, CMTG, and YY contributed to the conceptualization of this research; SRB worked out the mathematics required for the implementation and performed all necessary programming and analysis; SRB and CMTG contributed to writing the original draft; All authors contributed to editing the draft.\\
 \\
 \textbf{Manuscript 3:} Bhatnagar SR, Oualkacha K, Yang Y, Forest M, Greenwood CMT (2018+). A General Framework for Variable Selection in Linear Mixed Models with Applications to Genetic Studies with Structured Populations.\\
 Software: \url{https://github.com/greenwoodlab/ggmix}\\
 SRB, CMTG, and YY contributed to the conceptualization of this research; SRB worked out the mathematics required for the implementation and performed all necessary programming and analysis; SRB and CMTG contributed to writing the original draft; All authors contributed to editing the draft.\\
\end{comment}


	%-----------------------------------------------------------------------------
	%         English Abstract
	%-----------------------------------------------------------------------------
	
	\SetAbstractEnText{ 
In high-dimensional (HD) data, where the number of covariates ($p$) greatly exceeds the number of observations ($n$), estimation can benefit from the bet-on-sparsity principle, i.e., only a small number of predictors are relevant in the response. This assumption can lead to more interpretable models, improved predictive accuracy, and algorithms that are computationally efficient. In genomic and brain imaging studies, where the sample sizes are particularly small due to high data collection costs, we must often assume a sparse model because there isn't enough information to estimate $p$ parameters. For these reasons, penalized regression methods such as the lasso and group-lasso have generated substantial interest since they can set model coefficients exactly to zero. 
In the penalized regression framework, many approaches have been developed for main effects. However, there is a need for developing interaction and mixed-effects models. Indeed, accurate capture of interactions may hold the potential to better understand biological phenomena and improve prediction accuracy since they may reflect important modulation of a biological system by an external factor. Furthermore, penalized mixed-effects models that account for correlations due to groupings of observations can improve sensitivity and specificity. 
This thesis is composed primarily of three manuscripts. In the first manuscript, we propose a method called \texttt{sail} for detecting non-linear interactions that automatically enforces the strong heredity property using both the $\ell_1$ and $\ell_2$ penalty functions. We describe a blockwise coordinate descent procedure for solving the objective function and provide performance metrics on both simulated and real data. 
The second manuscript develops a general penalized mixed model framework to account for correlations in genetic data due to relatedness called \texttt{ggmix}. Our method can accommodate several sparsity-inducing penalties such as the lasso, elastic net and group lasso and also readily handles prior annotation information in the form of weights. Our algorithm has theoretical guarantees of convergence and we again assess its performance in both simulated and real data. We provide efficient implementations of all our algorithms in open source software.
The third manuscript describes a novel strategy called \texttt{eclust} for dimension reduction that leverages the effects of an exposure variable with broad impact on HD measures. With \texttt{eclust}, we found improved prediction and variable selection performance compared to methods that do not consider the exposure in the clustering step, or to methods that use the original data as features. We further illustrate this modeling framework through the analysis of three data sets from very different fields, each with HD data, a binary exposure, and a phenotype of interest.
	}
	\AbstractEn
	
	%-----------------------------------------------------------------------------
	%         French Abstract
	%-----------------------------------------------------------------------------
	
	\SetAbstractFrText{ 
Dans les données à haute dimension (HD), où le nombre de covariables ($ p $) dépasse largement le nombre d’observations ($ n $), l’estimation peut tirer parti du principe de la parité sur la base, c.-à-d. les prédicteurs sont pertinents dans la réponse. Cette hypothèse peut conduire à plus de modèles interprétables, à une meilleure précision prédictive et à des algorithmes efficaces sur le plan des calculs. Dans les études d'imagerie génomique et cérébrale, où la taille des échantillons est particulièrement faible en raison des coûts élevés de collecte de données, nous devons souvent supposer un modèle fragmenté car les informations sont insuffisantes pour estimer les paramètres $ p $. Pour ces raisons, les méthodes de régression pénalisées telles que le lasso et le lasso de groupe ont suscité un intérêt considérable car elles permettent de définir des coefficients de modèle à zéro.
Dans le cadre de la régression pénalisée, de nombreuses approches ont été développées pour les principaux effets. Cependant, il est nécessaire de développer des modèles d'interaction et à effets mixtes. En effet, une capture précise des interactions pourrait permettre de mieux comprendre les phénomènes biologiques et d’améliorer la précision des prédictions, car elles peuvent refléter une modulation importante d’un système biologique par un facteur externe. De plus, les modèles à effets mixtes pénalisés qui tiennent compte des corrélations dues aux regroupements d’observations peuvent améliorer la sensibilité et la spécificité.
Cette thèse est composée principalement de trois manuscrits. Dans le premier manuscrit, nous proposons une méthode appelée \texttt{sail} pour détecter les interactions non linéaires qui appliquent automatiquement la propriété d'hérédité forte à l'aide des fonctions $ \ell_1 $ et $ \ell_2 $ penalty. Nous décrivons une procédure de descente de coordonnées par blocs pour résoudre la fonction objectif et fournir des mesures de performance sur des données simulées et réelles.
Le deuxième manuscrit développe un cadre général de modèle mixte pénalisé pour tenir compte des corrélations dans les données génétiques dues à la parenté appelée \texttt{ggmix}. Notre méthode peut prendre en charge plusieurs pénalités induisant une faible densité, telles que le lasso, le filet élastique et le lasso de groupe. Elle traite également facilement les informations d’annotation antérieures sous forme de poids. Notre algorithme a des garanties théoriques de convergence et nous évaluons à nouveau ses performances à la fois en données simulées et en données réelles. Nous fournissons des implémentations efficaces de tous nos algorithmes dans les logiciels open source.
Le troisième manuscrit décrit une nouvelle stratégie appelée \texttt{eclust} pour la réduction de la dimension qui exploite les effets d'une variable d'exposition ayant un impact important sur les mesures HD. Avec \texttt{eclust}, nous avons constaté une amélioration des performances de prédiction et de sélection de variables par rapport aux méthodes qui ne tiennent pas compte de l'exposition lors de l'étape de clustering ou des méthodes utilisant les données d'origine comme fonctionnalités. Nous illustrons davantage ce cadre de modélisation en analysant trois ensembles de données provenant de domaines très différents, chacun avec des données HD, une exposition binaire et un phénotype d'intérêt.
	}
	\AbstractFr
	
	%-----------------------------------------------------------------------------
	% Tables
	%-----------------------------------------------------------------------------
	
	%\renewcommand{\contentsname}{Table of contents}
	\tableofcontents 

	\LOFHeading{List of Figures}
	\listoftables 
	\listoffigures
	
	\newpage
	
	\printacronyms[include-classes=abbrev,name=Abbreviations]
	\end{romanPagenumber}

\else
	% Skip all the previous sections
\fi

%-----------------------------------------------------------------------------
% Chapters
%-----------------------------------------------------------------------------

% McGill requires double spacing
\doublespacing

\ifthesis
	% Show all chapters on 'thesis' mode
	\include{chapters/introduction}
	\include{chapters/litreview}
	\include{chapters/sail}
	\include{chapters/ggmix}
	\include{chapters/eclust}
	\include{chapters/conclusion}
	\include{chapters/appendix}
\else
	% Only show the chapter we are currently working on (faster LaTex build)
	\include{chapters/introduction}
	\include{chapters/litreview}
	\include{chapters/sail}
	\include{chapters/ggmix}
	\include{chapters/eclust}
	\include{chapters/conclusion}
	\include{chapters/appendix}
\fi

%-----------------------------------------------------------------------------
% Appendices
%-----------------------------------------------------------------------------

\ifthesis
	% Show all appendices (if any)
\else
	% Skip all appendices and bibliography
\fi
	
%-----------------------------------------------------------------------------
% Bibliography. You need to run the following 
% command: 
%       bibtex thesis_mcgill
%-----------------------------------------------------------------------------
\bibHeading{References}
\bibliographystyle{apacite}
%\bibliographystyle{acm}
\bibliography{chapters/litreview,chapters/eclust,chapters/sail,chapters/ggmix}		% File: mcgilletd.bib

\end{document}
